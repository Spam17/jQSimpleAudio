/*
	AUTHOR: Osvaldas Valutis, www.osvaldas.info
*/
!function(t,e,i,a){var n="ontouchstart"in e,o=n?"touchstart":"mousedown",u=n?"touchmove":"mousemove",l=n?"touchcancel":"mouseup",d=function(t){var e=Math.floor(t/3600),i=Math.floor(t%3600/60),a=Math.ceil(t%3600%60);return(0==e?"":e>0&&e.toString().length<2?"0"+e+":":e+":")+(i.toString().length<2?"0"+i:i)+":"+(a.toString().length<2?"0"+a:a)};t.fn.audioPlayer=function(e){e=t.extend({classPrefix:"audioplayer",strPlay:"Play",strPause:"Pause",strVolume:"Volume"},e);var i={},a={playPause:"playpause",playing:"playing",time:"time",timeCurrent:"time-current",timeDuration:"time-duration",bar:"bar",barLoaded:"bar-loaded",barPlayed:"bar-played",volume:"volume",volumeButton:"volume-button",volumeAdjust:"volume-adjust",noVolume:"novolume",mute:"mute",mini:"mini"};for(var r in a)i[r]=e.classPrefix+"-"+a[r];return this.each(function(){if("audio"!=t(this).prop("tagName").toLowerCase())return!1;var a=t(this),r=a.attr("src"),s=""===(s=a.get(0).getAttribute("autoplay"))||"autoplay"===s,v=""===(v=a.get(0).getAttribute("loop"))||"loop"===v,m=!1;void 0===r?a.find("source").each(function(){if(void 0!==(r=t(this).attr("src")))return m=!0,!1}):m=!0;var c=t('<div class="'+e.classPrefix+'">'+(m?t("<div>").append(a.eq(0).clone()).html():'<embed src="'+r+'" width="0" height="0" volume="100" autostart="'+s.toString()+'" loop="'+v.toString()+'" />')+'<div class="'+i.playPause+'" title="'+e.strPlay+'"><a href="#">'+e.strPlay+"</a></div></div>"),h=(h=m?c.find("audio"):c.find("embed")).get(0);if(m){c.find("audio").css({width:0,height:0,visibility:"hidden"}),c.append('<div class="'+i.time+" "+i.timeCurrent+'"></div><div class="'+i.bar+'"><div class="'+i.barLoaded+'"></div><div class="'+i.barPlayed+'"></div></div><div class="'+i.time+" "+i.timeDuration+'"></div><div class="'+i.volume+'"><div class="'+i.volumeButton+'" title="'+e.strVolume+'"><a href="#">'+e.strVolume+'</a></div><div class="'+i.volumeAdjust+'"><div><div></div></div></div></div>');var f=c.find("."+i.bar),p=c.find("."+i.barPlayed),g=c.find("."+i.barLoaded),y=c.find("."+i.timeCurrent),b=c.find("."+i.timeDuration),P=c.find("."+i.volumeButton),C=c.find("."+i.volumeAdjust+" > div"),E=0,w=function(t){theRealEvent=n?t.originalEvent.touches[0]:t,h.currentTime=Math.round(h.duration*(theRealEvent.pageX-f.offset().left)/f.width())},L=function(t){theRealEvent=n?t.originalEvent.touches[0]:t,h.volume=Math.abs((theRealEvent.pageY-(C.offset().top+C.height()))/C.height())},x=setInterval(function(){g.width(h.buffered.end(0)/h.duration*100+"%"),h.buffered.end(0)>=h.duration&&clearInterval(x)},100),M=h.volume,S=h.volume=.111;Math.round(1e3*h.volume)/1e3==S?h.volume=M:c.addClass(i.noVolume),b.html("&hellip;"),y.text(d(0)),h.addEventListener("loadeddata",function(){b.text(d(h.duration)),C.find("div").height(100*h.volume+"%"),E=h.volume}),h.addEventListener("timeupdate",function(){y.text(d(h.currentTime)),p.width(h.currentTime/h.duration*100+"%")}),h.addEventListener("volumechange",function(){C.find("div").height(100*h.volume+"%"),h.volume>0&&c.hasClass(i.mute)&&c.removeClass(i.mute),h.volume<=0&&!c.hasClass(i.mute)&&c.addClass(i.mute)}),h.addEventListener("ended",function(){c.removeClass(i.playing)}),f.on(o,function(t){w(t),f.on(u,function(t){w(t)})}).on(l,function(){f.unbind(u)}),P.on("click",function(){return c.hasClass(i.mute)?(c.removeClass(i.mute),h.volume=E):(c.addClass(i.mute),E=h.volume,h.volume=0),!1}),C.on(o,function(t){L(t),C.on(u,function(t){L(t)})}).on(l,function(){C.unbind(u)})}else c.addClass(i.mini);s&&c.addClass(i.playing),c.find("."+i.playPause).on("click",function(){return c.hasClass(i.playing)?(t(this).attr("title",e.strPlay).find("a").html(e.strPlay),c.removeClass(i.playing),m?h.pause():h.Stop()):(t(this).attr("title",e.strPause).find("a").html(e.strPause),c.addClass(i.playing),m?h.play():h.Play()),!1}),a.replaceWith(c)}),this}}(jQuery,window,document);